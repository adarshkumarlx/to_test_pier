<?xml version="1.0" encoding="utf-8"?><!DOCTYPE topic  PUBLIC '-//OASIS//DTD DITA Topic//EN'  'topic.dtd'><topic id="GUID_High_Speed_I_O"><title>PCIe Gen 4</title><body><section id="SECTION_4562219A-6AFF-46FE-BCDA-F23EB355928A"><fig id="FIG_type-4_pcb_via_stitching_recommendation_1"><title>Type-4 PCB Via Stitching Recommendation</title><image href="FIG_type-4 pcb via stitching recommendation_1.png" scalefit="yes" id="IMG_type-4_pcb_via_stitching_recommendation_1_png" /></fig><fig id="FIG_recommended_gnd_stitching_via_placement_2"><title>Recommended GND Stitching Via Placement</title><image href="FIG_recommended gnd stitching via placement_2.png" scalefit="yes" id="IMG_recommended_gnd_stitching_via_placement_2_png" /></fig><fig id="FIG_pcie_board_layout_recommendation_smt_footprint_voiding_reference_2"><title>PCIE Board Layout Recommendation SMT footprint Voiding Reference</title><image href="FIG_pcie board layout recommendation smt footprint voiding reference_2.png" scalefit="yes" id="IMG_pcie_board_layout_recommendation_smt_footprint_voiding_reference_2_png" /></fig><fig id="FIG_pcie_board_layout_recommendation_ac_cap_voiding__2"><title>PCIE Board Layout Recommendation AC Cap Voiding </title><image href="FIG_pcie board layout recommendation ac cap voiding _2.png" scalefit="yes" id="IMG_pcie_board_layout_recommendation_ac_cap_voiding__2_png" /></fig><fig id="FIG_pcie4_m_2_connector_voiding_recommendation_2"><title>PCIE4 M.2 Connector Voiding Recommendation</title><image href="FIG_pcie4 m.2 connector voiding recommendation_2.png" scalefit="yes" id="IMG_pcie4_m_2_connector_voiding_recommendation_2_png" /></fig><fig id="FIG_pcie4_m_2_connector_toe_and_heel_gnd_via_recommendation_2"><title>PCIE4 M.2 Connector Toe and Heel GND Via Recommendation</title><image href="FIG_pcie4 m.2 connector toe and heel gnd via recommendation_2.png" scalefit="yes" id="IMG_pcie4_m_2_connector_toe_and_heel_gnd_via_recommendation_2_png" /></fig><fig id="FIG_pcie_board_layout_recommendation_toe_side_hsio_routing_2"><title>PCIE Board Layout Recommendation Toe Side HSIO Routing</title><image href="FIG_pcie board layout recommendation toe side hsio routing_2.png" scalefit="yes" id="IMG_pcie_board_layout_recommendation_toe_side_hsio_routing_2_png" /></fig><table id="TABLE_4562219A-6AFF-46FE-BCDA-F23EB355928A_1"><title>PCIe Gen 4 General Guidelines</title><tgroup cols="2"><thead><row><entry>Note</entry><entry>Detail</entry></row></thead><tbody><row><entry><p>Reference plane</p></entry><entry><p>(1) Continuous GND is recommended.</p><p>(2) If continuous GND cannot be implemented, a combination of GND on one side and continuous power plane on the other side with the condition that the GND plane be the closer reference (dual-reference) can be implemented. The continuous power plane requires low peak-to-peak noise and low current switching speed (di/dt). IO power rails with less than 5A max current can be considered for dual reference implementation.</p><p>(3) If non-continuous power referencing is required on microstrip/ surface layer, signal can reference over power planes with a low peak-to-peak noise and low current switching speed (di/dt), but stitching caps are required over each plane split within 6 mm of a signal running across the plane split.</p></entry></row><row><entry><p>Voiding recommendation for mainstream stackup</p></entry><entry><p>It is recommended to void unused (non-functional) pads reference plane for differential vias and pin pads for ESDs, AC caps and connectors to optimize the impedance matching in the channel.</p></entry></row><row><entry><p>PCIe4 AC capacitor size for mainstream stackup</p></entry><entry><p>It is required to use 0402. </p><p>If routing near maximum length it is recommended to use 0201 component size.</p></entry></row><row><entry><p>Unused signals</p></entry><entry><p>Unused data signals should be left as no connect at the ball.</p></entry></row><row><entry><p>Interleaved requirement</p></entry><entry><p>Refer to topology section for details.</p></entry></row><row><entry><p>PCIe4 max via stub length</p></entry><entry><p>&lt; 250 um</p></entry></row><row><entry><p>Via stub length relaxation</p></entry><entry><p>PTH via stub length can be relaxed, refer to "MTL-UH PCIe Gen4 Stub Length Requirement Relaxation White Paper" #723631 for details.</p></entry></row><row><entry><p>Routing and return via requirement near vertical transition</p></entry><entry><p>For all vertical transitions, the differential transmission line should be connected to the two vias symmetrically.  Moreover, Vss return vias should be placed near the signal vias in an equidistant symmetrical manner, and all signal vias should have identical Vss return vias around each of them.</p></entry></row><row><entry><p>PTH connector voiding requirement</p></entry><entry><p>Differential Oval Anti Pad required for all layers. For PCIe4, see topology specific notes for additional guidance.</p></entry></row><row><entry><p>Voiding under CEM SMT connector pads</p></entry><entry><p>Required</p></entry></row><row><entry><p>Fiberweave for PCIe4</p></entry><entry><p>Must adhere to fiberweave related best routing practices (#406926).</p></entry></row><row><entry><p>PCIe4 redriver</p></entry><entry><p>Routing length can be extended beyond the PDG guidelines by using redriver. Refer to document #575423 for details.</p></entry></row><row><entry><p>Routing in DSL configuration</p></entry><entry><p>If DSL configuration is used (for ex: PCIE4 is in layer 4 and there are signals routed in L3, this is assumed to be DSL configuration).</p><p>Avoid power or ground planes in layer 3 above PCIE4 signals.</p><p>Prefer low speed/GPIO signals in layer 3 above PCIE4 signals.</p></entry></row><row><entry><p>Parallel routing in DSL configuration</p></entry><entry><p>If signals are routed in same direction (less than 30 degrees between routing in layers 4 and layer 3), please refer to General Dual Stripline Routing Recommendations. </p></entry></row><row><entry><p>Cris-crossing signals in DSL configuration</p></entry><entry><p>For PCIE4 signals, recommended maximum number of cris-crossing signals is 15. If same signal cris-crossing twice, it is counted as 2 cris-crossings.</p></entry></row></tbody></tgroup></table><table id="TABLE_4562219A-6AFF-46FE-BCDA-F23EB355928A_2" scale="60"><title>PCIe Gen 4 Length Matching</title><tgroup cols="6"><thead><row valign="top"><entry outputclass="rotate90">Matching Group Id</entry><entry outputclass="rotate90">Matching Groups</entry><entry outputclass="rotate90">Total/Within Layer</entry><entry outputclass="rotate90">Length/Delay</entry><entry outputclass="rotate90">Required</entry><entry outputclass="rotate90">Maximum Mismatch</entry></row></thead><tbody><row><entry><p>1</p></entry><entry><p>Pair (P-N)</p></entry><entry><p>Total</p></entry><entry><p>Length (mm)</p></entry><entry><p>Yes</p></entry><entry><p>0.125</p></entry></row><row><entry><p>2</p></entry><entry><p>Pair (P-N)</p></entry><entry><p>Within</p></entry><entry><p>Length (mm)</p></entry><entry><p>Yes</p></entry><entry><p>0.25</p></entry></row><row><entry><p>3</p></entry><entry><p>TX-TX</p></entry><entry><p>Total</p></entry><entry><p>Length (mm)</p></entry><entry><p>Yes</p></entry><entry><p>25</p></entry></row><row><entry><p>4</p></entry><entry><p>RX-RX</p></entry><entry><p>Total</p></entry><entry><p>Length (mm)</p></entry><entry><p>Yes</p></entry><entry><p>25</p></entry></row><row><entry><p>5</p></entry><entry><p>TX-RX</p></entry><entry><p>Total</p></entry><entry><p>Length (mm)</p></entry><entry><p>No</p></entry><entry><p>0</p></entry></row><row><entry><p>6</p></entry><entry><p>DATA-CLK</p></entry><entry><p>Total</p></entry><entry><p>Length (mm)</p></entry><entry><p>No</p></entry><entry><p>0</p></entry></row></tbody></tgroup></table></section></body></topic>